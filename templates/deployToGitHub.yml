steps:
- checkout: github_pages
  path: "./target"
  
- task: DeleteFiles@1
  inputs:
    SourceFolder: '$(Agent.BuildDirectory)/target'
    Contents: '!(*.git)'

- task: CopyFiles@2
  inputs:
    SourceFolder: '$(Agent.BuildDirectory)/build-output'
    Contents: '**'
    TargetFolder: '$(Agent.BuildDirectory)/target'

- powershell: |
    git checkout master
    Write-Host "Set user.name to Pipeline"	
    git config user.name "Pipeline"
    Write-Host "Adding artifact directory: $(Agent.BuildDirectory)/target"
    git add "$(Agent.BuildDirectory)/target"
    Write-Host "Commit changes"
    git commit -m "Push build to master branch"
    Write-Host "Push the commit to origin"
    git push https://$env:SYSTEM_ACCESSTOKEN@github.com/machielvisser/machielvisser.github.io
